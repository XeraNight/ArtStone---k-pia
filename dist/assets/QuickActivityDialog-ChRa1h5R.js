import{c as S,r as o,j as e,B as f,n as A,t as d}from"./index-lYTtkRVl.js";import{D as F,e as $,f as E,g as L,h as M,P as h,M as x,i as I}from"./AppLayout-vg_1wxoQ.js";import{L as m,S as C,a as H,b as q,c as Z,d as l,I as B}from"./select-CrR1bKbv.js";import{T as Q}from"./textarea-DmnqyP04.js";import{b as R,C as T,S as p}from"./useActivities-Bb4Da46Z.js";const V=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],ee=S("history",V);const K=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],se=S("tag",K),O={call:"Telefonát",email:"Email",meeting:"Stretnutie",note:"Poznámka",status_change:"Zmena statusu"},U={call:e.jsx(h,{className:"h-4 w-4"}),email:e.jsx(x,{className:"h-4 w-4"}),meeting:e.jsx(T,{className:"h-4 w-4"}),note:e.jsx(p,{className:"h-4 w-4"}),status_change:e.jsx(p,{className:"h-4 w-4"})};function ae({open:w,onOpenChange:b,entityType:j,entityId:D,entityName:u,defaultType:v="note",defaultContact:a}){const[i,g]=o.useState(v),[t,r]=o.useState(""),[y,N]=o.useState(""),n=R(),c=s=>{s||(r(""),N(""),g(v)),b(s)},k=s=>{switch(s){case"call":return a?.phone?`Telefonát na ${a.phone}`:"Telefonát";case"email":return a?.email?`Email pre ${a.email}`:"Email";case"meeting":return"Stretnutie";case"note":return"Poznámka";default:return""}},P=s=>{g(s),t||r(k(s))},_=async s=>{if(s.preventDefault(),!t.trim()){d.error("Zadajte nadpis aktivity");return}try{await n.mutateAsync({entity_type:j,entity_id:D,activity_type:i,title:t.trim(),description:y.trim()||void 0}),d.success("Aktivita bola pridaná",{description:`${O[i]} pre ${u||"kontakt"}`}),c(!1)}catch(z){d.error("Chyba pri pridávaní aktivity",{description:z.message})}};return e.jsx(F,{open:w,onOpenChange:c,children:e.jsx($,{className:"sm:max-w-[500px]",children:e.jsxs("form",{onSubmit:_,children:[e.jsxs(E,{children:[e.jsx(L,{children:"Pridať aktivitu"}),e.jsxs(M,{children:["Rýchle zaznamenanie aktivity pre ",j==="lead"?"lead":"klienta"," ",u]})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"activity-type",children:"Typ aktivity"}),e.jsxs(C,{value:i,onValueChange:s=>P(s),children:[e.jsx(H,{id:"activity-type",children:e.jsx(q,{})}),e.jsxs(Z,{children:[e.jsx(l,{value:"call",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{className:"h-4 w-4"}),e.jsx("span",{children:"Telefonát"})]})}),e.jsx(l,{value:"email",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x,{className:"h-4 w-4"}),e.jsx("span",{children:"Email"})]})}),e.jsx(l,{value:"meeting",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{className:"h-4 w-4"}),e.jsx("span",{children:"Stretnutie"})]})}),e.jsx(l,{value:"note",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{className:"h-4 w-4"}),e.jsx("span",{children:"Poznámka"})]})})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"title",children:"Nadpis *"}),e.jsx(B,{id:"title",value:t,onChange:s=>r(s.target.value),placeholder:k(i),required:!0,autoFocus:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"description",children:"Popis (voliteľné)"}),e.jsx(Q,{id:"description",value:y,onChange:s=>N(s.target.value),placeholder:"Pridajte poznámky alebo detaily...",rows:4,className:"resize-none"})]}),(a?.email||a?.phone)&&e.jsxs("div",{className:"rounded-lg bg-muted/50 p-3 text-sm space-y-1",children:[e.jsx("p",{className:"font-medium text-muted-foreground",children:"Kontaktné údaje:"}),a.phone&&e.jsxs("div",{className:"flex items-center gap-2 text-foreground",children:[e.jsx(h,{className:"h-3 w-3"}),e.jsx("a",{href:`tel:${a.phone}`,className:"hover:underline",children:a.phone})]}),a.email&&e.jsxs("div",{className:"flex items-center gap-2 text-foreground",children:[e.jsx(x,{className:"h-3 w-3"}),e.jsx("a",{href:`mailto:${a.email}`,className:"hover:underline",children:a.email})]})]})]}),e.jsxs(I,{children:[e.jsx(f,{type:"button",variant:"outline",onClick:()=>c(!1),disabled:n.isPending,children:"Zrušiť"}),e.jsx(f,{type:"submit",disabled:n.isPending,children:n.isPending?e.jsxs(e.Fragment,{children:[e.jsx(A,{className:"mr-2 h-4 w-4 animate-spin"}),"Ukladám..."]}):e.jsxs(e.Fragment,{children:[U[i],e.jsx("span",{className:"ml-2",children:"Pridať"})]})})]})]})})})}export{ee as H,ae as Q,se as T};
