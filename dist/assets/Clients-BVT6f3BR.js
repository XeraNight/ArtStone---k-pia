import{c as A,r as c,u as J,j as e,B as m,n as G,t as g,S as W,l as Ne,g as $,C as ye,b as fe}from"./index-ixxTEzIM.js";import{u as _e,a as Ce,b as we,c as ke}from"./useClients-B5nG56wM.js";import{u as L}from"./useRegions-C9nCSrl3.js";import{L as r,I as h,S as _,a as C,b as w,c as k,d as y}from"./select-COUMOr2z.js";import{T as X}from"./textarea-6nmU1y0a.js";import{D as T,d as H,e as V,f as E,g as O,i as Y,B as ee,M as b,P as S,j as be,F as Se,b as Z,S as Fe,A as De,a as ze}from"./AppLayout-BqQJj8es.js";import{P,E as Me}from"./plus-_0AWnC6U.js";import{a as Pe,C as se,S as ae}from"./useActivities-BgmWqxSA.js";import{M as te}from"./map-pin-D6BAvuAg.js";import{T as Ae,H as Le,Q as Te}from"./QuickActivityDialog-BIzm7T0k.js";import{C as Ve}from"./CreateQuoteDialog-JdiqnU8t.js";import{E as Ee}from"./EmptyState-DjZh8hwW.js";import{D as Oe,a as Ie,b as Ue,c as f}from"./ThemeToggle-mam2t0E5.js";import{B as Ke}from"./building-2-UQjXoNMs.js";import"./demoData-tljgfLqM.js";import"./useInventory-DcHlp9F-.js";import"./table-8lq7_8Yr.js";import"./trash-2-BweOqF1V.js";const Qe=[["path",{d:"M4 10h12",key:"1y6xl8"}],["path",{d:"M4 14h9",key:"1loblj"}],["path",{d:"M19 6a7.7 7.7 0 0 0-5.2-2A7.9 7.9 0 0 0 6 12c0 4.4 3.5 8 7.8 8 2 0 3.8-.8 5.2-2",key:"1j6lzo"}]],Be=A("euro",Qe);const Re=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],$e=A("grid-3x3",Re);const He=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],Ze=A("list",He);function qe(){const[n,x]=c.useState(!1),[l,a]=c.useState({contact_name:"",company_name:"",email:"",phone:"",address:"",postal_code:"",region_id:"",status:"prospect",notes:""}),i=_e(),{data:p=[]}=L(),{user:j}=J();j?.role==="admin"||j?.role;const v=async s=>{if(s.preventDefault(),!l.contact_name){g.error("Meno kontaktnej osoby je povinné");return}try{await i.mutateAsync({contact_name:l.contact_name,company_name:l.company_name||null,email:l.email||null,phone:l.phone||null,address:l.address||null,postal_code:l.postal_code||null,region_id:l.region_id||null,status:l.status,notes:l.notes||null}),g.success("Klient bol úspešne vytvorený"),x(!1),a({contact_name:"",company_name:"",email:"",phone:"",address:"",postal_code:"",region_id:"",status:"prospect",notes:""})}catch(o){console.error("Create client error:",o),g.error(o.message||"Nepodarilo sa vytvoriť klienta"),o.details&&g.error(o.details)}};return e.jsxs(T,{open:n,onOpenChange:x,children:[e.jsx(H,{asChild:!0,children:e.jsx(m,{className:"md:hidden min-h-[44px] min-w-[44px]",size:"icon",title:"Nový klient",children:e.jsx(P,{className:"h-4 w-4"})})}),e.jsx(H,{asChild:!0,children:e.jsxs(m,{className:"hidden md:flex",children:[e.jsx(P,{className:"h-4 w-4 mr-2"}),"Nový klient"]})}),e.jsxs(V,{className:"max-w-[95vw] sm:max-w-[500px]",children:[e.jsx(E,{children:e.jsx(O,{children:"Vytvoriť nového klienta"})}),e.jsxs("form",{onSubmit:v,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"contact_name",children:"Meno a priezvisko *"}),e.jsx(h,{id:"contact_name",placeholder:"Ján Novák",value:l.contact_name,onChange:s=>a({...l,contact_name:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"company_name",children:"Firma"}),e.jsx(h,{id:"company_name",placeholder:"Firma s.r.o.",value:l.company_name,onChange:s=>a({...l,company_name:s.target.value})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"email",children:"Email"}),e.jsx(h,{id:"email",type:"email",placeholder:"jan@example.com",value:l.email,onChange:s=>a({...l,email:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"phone",children:"Telefón"}),e.jsx(h,{id:"phone",placeholder:"+421 9xx xxx xxx",value:l.phone,onChange:s=>a({...l,phone:s.target.value})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"address",children:"Adresa"}),e.jsx(h,{id:"address",placeholder:"Ulica 123",value:l.address,onChange:s=>a({...l,address:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"postal_code",children:"PSČ"}),e.jsx(h,{id:"postal_code",placeholder:"000 00",value:l.postal_code,onChange:s=>a({...l,postal_code:s.target.value})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"region",children:"Región"}),e.jsxs(_,{value:l.region_id,onValueChange:s=>a({...l,region_id:s}),children:[e.jsx(C,{children:e.jsx(w,{placeholder:"Vyberte región"})}),e.jsx(k,{children:p.map(s=>e.jsx(y,{value:s.id,children:s.name},s.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"notes",children:"Poznámka"}),e.jsx(X,{id:"notes",placeholder:"Interné poznámky...",value:l.notes,onChange:s=>a({...l,notes:s.target.value})})]}),e.jsxs(Y,{children:[e.jsx(m,{type:"button",variant:"outline",onClick:()=>x(!1),disabled:i.isPending,children:"Zrušiť"}),e.jsx(m,{type:"submit",disabled:i.isPending,children:i.isPending?e.jsxs(e.Fragment,{children:[e.jsx(G,{className:"mr-2 h-4 w-4 animate-spin"}),"Vytváram..."]}):"Vytvoriť klienta"})]})]})]})]})}const Je={active:"Aktívny",inactive:"Neaktívny",prospect:"Potenciálny",completed:"Ukončená spolupráca"};function Ge({client:n,open:x,onOpenChange:l}){const[a,i]=c.useState({contact_name:"",company_name:"",email:"",phone:"",address:"",postal_code:"",region_id:"",notes:"",status:"prospect",total_value:""}),p=Ce(),{data:j=[]}=L();c.useEffect(()=>{n&&i({contact_name:n.contact_name||"",company_name:n.company_name||"",email:n.email||"",phone:n.phone||"",address:n.address||"",postal_code:n.postal_code||"",region_id:n.region_id||"",notes:n.notes||"",status:n.status||"prospect",total_value:n.total_value?.toString()||""})},[n,x]);const v=async s=>{if(s.preventDefault(),!!n){if(!a.contact_name){g.error("Meno kontaktnej osoby je povinné");return}try{await p.mutateAsync({id:n.id,contact_name:a.contact_name,company_name:a.company_name||null,email:a.email||null,phone:a.phone||null,address:a.address||null,postal_code:a.postal_code||null,region_id:a.region_id||null,notes:a.notes||null,status:a.status,total_value:a.total_value?parseFloat(a.total_value):0}),g.success("Klient bol úspešne aktualizovaný"),l(!1)}catch(o){g.error("Nepodarilo sa aktualizovať klienta"),console.error(o)}}};return e.jsx(T,{open:x,onOpenChange:l,children:e.jsxs(V,{className:"sm:max-w-[500px] max-h-[90vh] overflow-y-auto",children:[e.jsx(E,{children:e.jsx(O,{children:"Upraviť klienta"})}),e.jsxs("form",{onSubmit:v,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"edit-status",children:"Status"}),e.jsxs(_,{value:a.status,onValueChange:s=>i({...a,status:s}),children:[e.jsx(C,{children:e.jsx(w,{placeholder:"Status"})}),e.jsx(k,{children:Object.entries(Je).map(([s,o])=>e.jsx(y,{value:s,children:o},s))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"edit-total_value",children:"Celková hodnota (€)"}),e.jsx(h,{id:"edit-total_value",type:"number",min:"0",step:"0.01",placeholder:"0.00",value:a.total_value,onChange:s=>i({...a,total_value:s.target.value})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"edit-contact_name",children:"Meno a priezvisko *"}),e.jsx(h,{id:"edit-contact_name",placeholder:"Ján Novák",value:a.contact_name,onChange:s=>i({...a,contact_name:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"edit-company_name",children:"Firma"}),e.jsx(h,{id:"edit-company_name",placeholder:"Firma s.r.o.",value:a.company_name,onChange:s=>i({...a,company_name:s.target.value})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"edit-email",children:"Email"}),e.jsx(h,{id:"edit-email",type:"email",placeholder:"jan@example.com",value:a.email,onChange:s=>i({...a,email:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"edit-phone",children:"Telefón"}),e.jsx(h,{id:"edit-phone",placeholder:"+421 9xx xxx xxx",value:a.phone,onChange:s=>i({...a,phone:s.target.value})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"edit-address",children:"Adresa"}),e.jsx(h,{id:"edit-address",placeholder:"Ulica 123",value:a.address,onChange:s=>i({...a,address:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"edit-postal_code",children:"PSČ"}),e.jsx(h,{id:"edit-postal_code",placeholder:"000 00",value:a.postal_code,onChange:s=>i({...a,postal_code:s.target.value})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"edit-region",children:"Región"}),e.jsxs(_,{value:a.region_id,onValueChange:s=>i({...a,region_id:s}),children:[e.jsx(C,{children:e.jsx(w,{placeholder:"Vyberte región"})}),e.jsx(k,{children:j.map(s=>e.jsx(y,{value:s.id,children:s.name},s.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"edit-notes",children:"Poznámka"}),e.jsx(X,{id:"edit-notes",placeholder:"Interné poznámky...",value:a.notes,onChange:s=>i({...a,notes:s.target.value})})]}),e.jsxs(Y,{children:[e.jsx(m,{type:"button",variant:"outline",onClick:()=>l(!1),disabled:p.isPending,children:"Zrušiť"}),e.jsx(m,{type:"submit",disabled:p.isPending,children:p.isPending?e.jsxs(e.Fragment,{children:[e.jsx(G,{className:"mr-2 h-4 w-4 animate-spin"}),"Ukladám..."]}):"Uložiť zmeny"})]})]})]})})}const We={call:e.jsx(S,{className:"h-4 w-4"}),email:e.jsx(b,{className:"h-4 w-4"}),meeting:e.jsx(se,{className:"h-4 w-4"}),note:e.jsx(ae,{className:"h-4 w-4"}),status_change:e.jsx(Ne,{className:"h-4 w-4"})};function Xe({client:n,open:x,onOpenChange:l,statusLabels:a,statusVariants:i,getRegionName:p,formatCurrency:j,onEdit:v}){const{data:s=[],isLoading:o}=Pe({entityType:"client",entityId:n?.id,limit:5});return n?e.jsx(T,{open:x,onOpenChange:l,children:e.jsxs(V,{className:"max-w-[95vw] sm:max-w-[600px] max-h-[85vh] overflow-y-auto",children:[e.jsxs(E,{children:[e.jsxs("div",{className:"flex items-center justify-between mr-8",children:[e.jsx(O,{className:"text-xl",children:n.contact_name}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{variant:i[n.status],children:a[n.status]}),v&&e.jsx(m,{variant:"outline",size:"sm",onClick:v,children:"Upraviť"})]})]}),n.company_name&&e.jsx("p",{className:"text-muted-foreground mt-1",children:n.company_name})]}),e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("section",{className:"space-y-3",children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground uppercase tracking-wider",children:"Kontaktné údaje"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[n.email&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(b,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("a",{href:`mailto:${n.email}`,className:"hover:underline",children:n.email})]}),n.phone&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(S,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("a",{href:`tel:${n.phone}`,className:"hover:underline",children:n.phone})]}),(n.address||n.postal_code)&&e.jsxs("div",{className:"flex items-start gap-2 text-sm sm:col-span-2",children:[e.jsx(te,{className:"h-4 w-4 text-muted-foreground mt-0.5"}),e.jsx("span",{children:[n.address,n.postal_code].filter(Boolean).join(", ")})]})]})]}),e.jsxs("section",{className:"space-y-3",children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground uppercase tracking-wider",children:"Informácie"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("span",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[e.jsx(Ae,{className:"h-3 w-3"})," Región"]}),e.jsx("p",{className:"text-sm font-medium",children:p(n.region_id)})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("span",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[e.jsx(be,{className:"h-3 w-3"})," Priradené"]}),e.jsx("p",{className:"text-sm font-medium",children:n.assigned_user?.full_name||"Nepriradené"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("span",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[e.jsx(Be,{className:"h-3 w-3"})," Celková hodnota"]}),e.jsx("p",{className:"text-sm font-medium",children:j(n.total_value)})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("span",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[e.jsx(se,{className:"h-3 w-3"})," Vytvorené"]}),e.jsx("p",{className:"text-sm font-medium",children:new Date(n.created_at).toLocaleDateString("sk-SK")})]})]})]}),n.notes&&e.jsxs("section",{className:"space-y-3",children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground uppercase tracking-wider",children:"Poznámka"}),e.jsx("div",{className:"bg-muted/50 p-4 rounded-lg text-sm whitespace-pre-wrap",children:n.notes})]}),e.jsxs("section",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Le,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("h4",{className:"text-sm font-medium text-muted-foreground uppercase tracking-wider",children:"Posledné aktivity"})]}),o?e.jsx("div",{className:"space-y-3",children:[1,2,3].map(u=>e.jsx(W,{className:"h-16 w-full"},u))}):s.length===0?e.jsx("div",{className:"text-center py-8 text-sm text-muted-foreground bg-muted/30 rounded-lg",children:"Žiadne aktivity"}):e.jsx("div",{className:"space-y-3",children:s.map(u=>e.jsxs("div",{className:"flex gap-3 p-3 rounded-lg bg-muted/30 hover:bg-muted/50 transition-colors",children:[e.jsx("div",{className:"text-primary mt-0.5",children:We[u.activity_type]||e.jsx(Se,{className:"h-4 w-4"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:u.title}),e.jsx("span",{className:"text-xs text-muted-foreground whitespace-nowrap",children:new Date(u.created_at).toLocaleDateString("sk-SK")})]}),u.description&&e.jsx("p",{className:"text-sm text-muted-foreground mt-1 line-clamp-2",children:u.description})]})]},u.id))})]})]})]})}):null}const M={active:"Aktívny",inactive:"Neaktívny",prospect:"Potenciálny",completed:"Vybavený"},q={active:"success",inactive:"secondary",prospect:"info",completed:"completed"};function gs(){const{user:n}=J(),[x,l]=c.useState(""),[a,i]=c.useState("all"),[p,j]=c.useState("grid"),[v,s]=c.useState(null),[o,u]=c.useState(null),[ne,F]=c.useState(!1),[le,D]=c.useState(!1),[ie,I]=c.useState(!1),[re,oe]=c.useState(""),[ce,U]=c.useState(!1),[de,me]=c.useState("note"),{data:he=[],isLoading:K,isError:xe}=we(),{data:pe=[]}=L(),ue=ke(),je=n?.role==="admin",Q=he.filter(t=>{const d=t.contact_name?.toLowerCase().includes(x.toLowerCase())||t.email?.toLowerCase().includes(x.toLowerCase())||t.company_name?.toLowerCase().includes(x.toLowerCase()),N=a==="all"||t.status===a;return d&&N}),B=t=>t&&pe.find(N=>N.id===t)?.name||"Neurčený",R=t=>new Intl.NumberFormat("sk-SK",{style:"currency",currency:"EUR"}).format(t||0),ge=async t=>{if(confirm("Naozaj chcete vymazať tohto klienta?"))try{await ue.mutateAsync(t),g.success("Klient bol vymazaný")}catch{g.error("Nepodarilo sa vymazať klienta")}},ve=t=>{u(t),F(!0)},z=(t,d,N)=>{N.stopPropagation(),u(t),me(d),U(!0)};return xe?e.jsx(Z,{title:"Klienti",children:e.jsxs("div",{className:"p-8 text-center text-destructive",children:[e.jsx("p",{children:"Nepodarilo sa načítať zoznam klientov."}),e.jsx(m,{variant:"outline",onClick:()=>window.location.reload(),className:"mt-4",children:"Skúsiť znova"})]})}):e.jsx(Z,{title:"Klienti",children:e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-between",children:[e.jsxs("div",{className:"flex flex-1 gap-3",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(Fe,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(h,{placeholder:"Hľadať klientov...",value:x,onChange:t=>l(t.target.value),className:"pl-9"})]}),e.jsxs(_,{value:a,onValueChange:i,children:[e.jsx(C,{className:"w-40",children:e.jsx(w,{placeholder:"Status"})}),e.jsxs(k,{children:[e.jsx(y,{value:"all",children:"Všetky statusy"}),Object.entries(M).map(([t,d])=>e.jsx(y,{value:t,children:d},t))]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex border border-border rounded-lg p-1",children:[e.jsx(m,{variant:p==="grid"?"secondary":"ghost",size:"icon-sm",onClick:()=>j("grid"),children:e.jsx($e,{className:"h-4 w-4"})}),e.jsx(m,{variant:p==="list"?"secondary":"ghost",size:"icon-sm",onClick:()=>j("list"),children:e.jsx(Ze,{className:"h-4 w-4"})})]}),e.jsx(qe,{})]})]}),K?e.jsx("div",{className:$("grid gap-4",p==="grid"?"md:grid-cols-2 lg:grid-cols-3":"grid-cols-1"),children:[1,2,3,4,5,6].map(t=>e.jsx(W,{className:"h-[220px]"},t))}):e.jsx("div",{className:$("grid gap-4",p==="grid"?"md:grid-cols-2 lg:grid-cols-3":"grid-cols-1"),children:Q.map(t=>e.jsx(ye,{className:"shadow-soft hover:shadow-md transition-all duration-200 cursor-pointer group",children:e.jsxs(fe,{className:"p-5",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(De,{className:"h-12 w-12 bg-primary/10",children:e.jsx(ze,{className:"bg-primary/10 text-primary font-medium",children:(t.contact_name||"?").split(" ").map(d=>d[0]).join("").substring(0,2)})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-foreground",children:t.contact_name}),t.company_name&&e.jsxs("p",{className:"text-sm text-muted-foreground flex items-center gap-1",children:[e.jsx(Ke,{className:"h-3 w-3"}),t.company_name]})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[t.phone&&e.jsx(m,{variant:"ghost",size:"icon-sm",onClick:d=>z(t,"call",d),className:"h-7 w-7 text-muted-foreground hover:text-foreground",title:"Zavolať",children:e.jsx(S,{className:"h-3.5 w-3.5"})}),t.email&&e.jsx(m,{variant:"ghost",size:"icon-sm",onClick:d=>z(t,"email",d),className:"h-7 w-7 text-muted-foreground hover:text-foreground",title:"Poslať email",children:e.jsx(b,{className:"h-3.5 w-3.5"})}),e.jsx(m,{variant:"ghost",size:"icon-sm",onClick:d=>z(t,"note",d),className:"h-7 w-7 text-muted-foreground hover:text-foreground",title:"Pridať poznámku",children:e.jsx(ae,{className:"h-3.5 w-3.5"})})]}),e.jsxs(Oe,{children:[e.jsx(Ie,{asChild:!0,children:e.jsx(m,{variant:"ghost",size:"icon-sm",className:"opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(Me,{className:"h-4 w-4"})})}),e.jsxs(Ue,{align:"end",children:[e.jsx(f,{onClick:()=>ve(t),children:"Zobraziť detail"}),e.jsx(f,{onClick:()=>{oe(t.id),I(!0)},children:"Vytvoriť ponuku"}),(je||n?.role==="manager")&&e.jsxs(e.Fragment,{children:[e.jsx(f,{onClick:()=>{s(t),D(!0)},children:"Upraviť"}),e.jsx(f,{className:"text-destructive",onClick:()=>ge(t.id),children:"Vymazať"})]})]})]})]})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[t.email&&e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(b,{className:"h-4 w-4"}),e.jsx("span",{className:"truncate",children:t.email})]}),t.phone&&e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(S,{className:"h-4 w-4"}),e.jsx("span",{children:t.phone})]}),t.address&&e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(te,{className:"h-4 w-4"}),e.jsx("span",{className:"truncate",children:t.address})]})]}),e.jsxs("div",{className:"flex items-center justify-between mt-4 pt-4 border-t border-border",children:[e.jsx(ee,{variant:q[t.status],children:M[t.status]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Celková hodnota"}),e.jsx("p",{className:"font-semibold text-foreground",children:R(t.total_value)})]})]}),e.jsxs("div",{className:"flex items-center justify-between mt-3 text-xs text-muted-foreground",children:[e.jsx("span",{children:B(t.region_id)}),e.jsx("span",{children:t.assigned_user?.full_name||"—"})]})]})},t.id))}),!K&&Q.length===0&&e.jsx(Ee,{icon:e.jsx(Users,{className:"h-full w-full"}),title:"Ešte nemáte žiadnych klientov",description:"Pridajte svojho prvého klienta alebo konvertujte lead na klienta.",action:{label:"Pridať klienta",onClick:()=>setCreateDialogOpen(!0),icon:e.jsx(P,{className:"h-4 w-4"})}}),e.jsx(Xe,{client:o,open:ne,onOpenChange:F,statusLabels:M,statusVariants:q,getRegionName:B,formatCurrency:R,onEdit:()=>{F(!1),s(o),D(!0)}}),e.jsx(Ge,{client:v,open:le,onOpenChange:D}),e.jsx(Ve,{open:ie,onOpenChange:I,defaultClientId:re}),e.jsx(Te,{open:ce,onOpenChange:U,entityType:"client",entityId:o?.id||"",entityName:o?.contact_name,defaultType:de,defaultContact:{email:o?.email||void 0,phone:o?.phone||void 0}})]})})}export{gs as default};
